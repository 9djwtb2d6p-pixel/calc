<html lang="en" style="--s-video-dl-bg: rgb(54, 54, 57); --s-video-font: rgb(247,247,247); --s-video-hd-bg: #4b4b4b; --s-video-posterbg: rgba(0, 0, 0, 1); --s-video-font2: #DCDCDC; --s-video-line: #4d4d4d; --s-video-modal-bg: rgba(0, 0, 0, 0.4); --s-video-000-bg: rgba(0,0,0,0);"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart AI Grade Calculator</title>
<style>
:root{
  --bg-dark:#0d1117;
  --bg-light:#f7f7f9;
  --card-dark:rgba(22,27,35,0.9);
  --card-light:rgba(255,255,255,0.9);
  --accent1:#6a7cff;
  --accent2:#3dd6c6;
  --good:#6fe3b6;
  --warn:#ffbe5b;
  --bad:#ff7d7d;
  --text-dark:#e8eef3;
  --text-light:#111;
  --muted-dark:#8a93a2;
  --muted-light:#555;
  --shadow-dark:0 20px 40px rgba(0,0,0,0.5);
  --shadow-light:0 20px 40px rgba(0,0,0,0.15);
  --transition:0.35s ease;
  font-family:"Inter","Segoe UI",Roboto,sans-serif;
}

body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:flex-start;
  padding:40px 20px;
  background:linear-gradient(135deg,#0d1117,#12151c);
  color:var(--text-dark);
  overflow-x:hidden;
  transition:background var(--transition), color var(--transition);
}

body.light{
  background:#f7f7f9;
  color:var(--text-light);
}

.container{
  position:relative;
  width:100%;
  max-width:720px;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:20px;
}

.card{
  width:100%;
  background:var(--card-dark);
  backdrop-filter:blur(20px);
  border-radius:25px;
  padding:30px 25px;
  box-shadow:var(--shadow-dark);
  display:flex;
  flex-direction:column;
  gap:15px;
  position:relative;
}

body.light .card{
  background:var(--card-light);
  box-shadow:var(--shadow-light);
}

h1{
  font-size:3rem;
  font-weight:800;
  margin:0;
  text-align:center;
  background:linear-gradient(90deg,var(--accent1),var(--accent2));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

.help-overlay{
  position:fixed;
  top:20px;
  right:20px;
  background:rgba(255,255,255,0.15);
  backdrop-filter:blur(10px);
  padding:15px 20px;
  border-radius:20px;
  color:var(--text-dark);
  font-size:14px;
  max-width:250px;
  box-shadow:0 10px 30px rgba(0,0,0,0.3);
  transition:all 0.3s ease;
  z-index:100;
}

body.light .help-overlay{color:var(--text-light); background:rgba(255,255,255,0.95);}

.grades{display:flex;flex-direction:column;gap:15px; width:100%;}

.grade-row{
  display:flex;
  flex-direction:column;
  gap:8px;
  cursor:grab;
  user-select:none;
  opacity:0; transform:scale(0.95);
  transition:all 0.3s ease;
  position:relative;
}
.grade-row.show{opacity:1;transform:scale(1);}
.grade-row.dragging{opacity:0.7;transform:scale(1.05);box-shadow:0 15px 35px rgba(0,0,0,0.4);}

.grade-inputs{display:flex;gap:10px;width:100%;}
.grade-row input{
  flex:1;
  padding:14px 18px;
  border-radius:20px;
  border:1px solid rgba(255,255,255,0.1);
  background:rgba(255,255,255,0.05);
  color:var(--text-dark);
  font-size:16px;
  transition:all 0.3s ease;
}
body.light .grade-row input{color:var(--text-light);}
.grade-row input:focus{
  outline:none;
  border-color:var(--accent1);
  background:rgba(255,255,255,0.12);
  box-shadow:0 0 15px rgba(106,124,255,0.3);
}

.remove-btn{
  padding:6px 14px;
  font-size:13px;
  background:var(--bad);
  color:#fff;
  border-radius:18px;
  border:none;
  cursor:pointer;
  transition:all 0.25s ease;
}
.remove-btn:hover{transform:scale(1.1); opacity:0.9;}

.suggestion{
  font-size:12px;
  color:var(--muted-dark);
}
body.light .suggestion{color:var(--muted-light);}

.grade-bar{
  width:100%;
  height:14px;
  border-radius:12px;
  background:rgba(255,255,255,0.05);
  overflow:hidden;
  transition:all 0.4s ease;
}
.grade-bar-fill{
  height:100%;
  width:0%;
  border-radius:12px;
  transition:width 0.5s ease, background 0.4s ease;
}

.result{
  text-align:center;
  padding:25px;
  border-radius:25px;
  background:rgba(255,255,255,0.05);
  border:1px solid rgba(255,255,255,0.08);
  box-shadow:0 15px 35px rgba(0,0,0,0.45);
  display:flex;
  flex-direction:column;
  gap:15px;
  width:100%;
}

.result .num{
  font-size:3rem;
  font-weight:700;
  background:linear-gradient(90deg,var(--accent1),var(--accent2));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  transition:all 0.4s ease;
}
.result .num.animate{animation:pulse 0.5s;}
@keyframes pulse{0%{transform:scale(1);}50%{transform:scale(1.15);}100%{transform:scale(1);}}
.result .letter{font-size:2rem;font-weight:700;}

button.add-btn{
  padding:14px 20px;
  font-size:16px;
  border-radius:25px;
  background:linear-gradient(90deg,var(--accent1),var(--accent2));
  color:#071027;
  font-weight:600;
  border:none;
  cursor:pointer;
  transition:all 0.3s ease;
}
button.add-btn:hover{transform:scale(1.05);box-shadow:0 0 20px rgba(106,124,255,0.4);}

#settingsBtn{
  position:absolute;
  top:20px; right:20px;
  background:var(--accent2);
  color:#071027;
  border:none;
  padding:10px 12px;
  border-radius:18px;
  cursor:pointer;
  transition:all 0.3s ease;
}
#settingsBtn:hover{transform:scale(1.1);}

#settingsPanel{
  position:absolute;
  top:60px; right:20px;
  background:var(--card-dark);
  padding:20px;
  border-radius:20px;
  box-shadow:0 15px 35px rgba(0,0,0,0.5);
  display:none;
  flex-direction:column;
  gap:15px;
  min-width:200px;
  z-index:10;
  transition:all 0.3s ease;
}
body.light #settingsPanel{background:var(--card-light);}
#settingsPanel button{
  padding:10px 14px;
  border-radius:18px;
  border:none;
  cursor:pointer;
  transition:all 0.25s ease;
  font-size:15px;
}
#settingsPanel button:hover{transform:scale(1.05);}
input[type="file"]{display:none;}

@media(max-width:600px){
  .card{padding:20px;}
  h1{font-size:2rem;}
  .grade-row input{font-size:15px;padding:12px 14px;}
  .remove-btn{padding:5px 12px;font-size:12px;}
  .result .num{font-size:2.4rem;}
  .result .letter{font-size:1.8rem;}
  button.add-btn{font-size:15px;padding:12px;}
}
</style>
<script type="text/javascript" id="__stay_inject_utils_js_">

const handle__stay_inject_utils_js_1WJOQ33B = function t(){let t;const r=new Map,e={platform:"Safari",isChecking:()=>{let t=new Date("2025-08-31 00:00:00"),r=new Date;return r<t},IMAGE_SUFFIX:{apng:"apng",bmp:"bmp",gif:"gif",ico:"ico",cur:"ico",pjp:"jpeg",pjpeg:"jpeg",jfif:"jpeg",jpeg:"jpeg",jpg:"jpeg",png:"png",pnj:"png",svg:"svg",tiff:"tiff",tif:"tiff",webp:"webp"},compare:function(t){return(r,e)=>{let n=r[t],o=e[t];return"number"!=typeof n&&(n=n.replace(/[^0-9]/g,""),n=n?Number(n):0),"number"!=typeof o&&(o=o.replace(/[^0-9]/g,""),o=o?Number(o):0),o-n}},isIpad:function(){const t=navigator.userAgent;let r=["iPad"],e=r.filter((r=>t.includes(r))),n=!!e.length;return n||(!!(t.match(/Macintosh/)&&navigator.maxTouchPoints>1)||n)},isMobile:function(){const t=navigator.userAgent;let r=["Android","iPhone","SymbianOS","Windows Phone","iPod"],e=r.filter((r=>t.includes(r)));return!!e.length},removeUrlParameter:function(t,r){if(!t)return"";const e=new URL(t);return e.searchParams.delete(r),e.toString()},replaceUrlArg:function(t,r,e){const n=new URL(t);return n.searchParams.set(r,e),n.href},queryURLParams:function(t,r){const e=new RegExp("[?&#]+"+r+"=([^?&#]+)"),n=e.exec(t);return n&&n[1]?n[1]:""},queryParams:function(t,r){if(!t)return"";let n="https;//stap.app?"+t;return e.queryURLParams(n,r)},getLastPathParameter:function(t){const r=new URL(t).pathname,e=r.split("/").filter((t=>""!==t));return e[e.length-1]},matchUrlInString:function(t){const r=new RegExp("(https?|http)?(:)?//[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]","g"),e=t.match(r);return e&&e.length?e[0]:""},isURL:function(t){return!!t&&/^http[s]?:\/\/.*/.test(t)},completionSourceUrl:function(t){return t?/^blob:/i.test(t)?window.location.href:(/^(f|ht)tps?:\/\//i.test(t)||(t=/^\/\//i.test(t)?window.location.protocol+t:/^\//i.test(t)?window.location.origin+t:window.location.origin+window.location.pathname+t),t):""},checkCharLengthAndSubStr:function(t,r){if(!t)return"";r||(r=80);let e=t.replace(/[^x00-xff]/g,"01");return e.length<=r?t:t.substr(0,r)},isChinese(t){return!!t&&!!/.*[u4e00-u9fa5]+.*$/.test(t)},urlEncodeChinese(t){if(!t)return t;let r=new RegExp("[\\u4E00-\\u9FFF]","g");return t.replace(r,(function(t){return window.encodeURI(t)}))},getUrlPathName:function(t){let r="";r=e.isURL(t)?new URL(t).pathname:window.location.pathname;let n=r.split("/");return n=n.filter((t=>{if(t&&""!=t)return t})),n.pop()},generateUuid:function(t,r){t=t?t>32?32:t:32;let e,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),o=[];if(r=r?r>n.length?n.length:r:n.length,t)for(e=0;e<t;e++)o[e]=n[0|Math.random()*r];else{let t;for(o[8]=o[13]=o[18]=o[23]="_",o[14]="4",e=0;e<36;e++)o[e]||(t=0|16*Math.random(),o[e]=n[19==e?3&t|8:t])}return o.join("")},isBlobUrl:function(t){const r=/^blob:/;return r.test(t)},isBase64(t){if(!t)return!1;if(/^data:.*\w+;base64,/.test(t))return!0;if(""===t||""===t.trim())return!1;try{return window.btoa(window.atob(t))==t}catch(r){return!1}},isExtensionUrl:function(t){t=t||"";const r=new RegExp("^(chrome-?|moz-)?(extension)?(:)?//[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]","g");return t.match(r)},isDark(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches},parseToDOM(t){let r=document.createElement("template");return"string"==typeof t?(r.innerHTML=t,r.content):t},isHidden(t){if(!t)return!0;let r=window.getComputedStyle(t);return!!r&&("none"===r.display||"hidden"===r.visibility)},getHostname(t){if(!t)return"";try{return new URL(t).hostname.toLowerCase()}catch(r){return t.split("/")[0].toLowerCase()}},div(t,r){let n,o,i=0,u=0;try{i=t.toString().split(".")[1].length}catch(c){i=0}try{u=r.toString().split(".")[1].length}catch(c){u=0}return n=Number(t.toString().replace(".","")),o=Number(r.toString().replace(".","")),e.mul(n/o,Math.pow(10,u-i))},sub(t,r){let n,o,i;try{n=t.toString().split(".")[1].length}catch(u){n=0}try{o=r.toString().split(".")[1].length}catch(u){o=0}return i=Math.pow(10,Math.max(n,o)),(e.mul(t,i)-e.mul(r,i))/i},mul(t,r){let e=0,n=t.toString(),o=r.toString();try{e+=n.split(".")[1].length}catch(i){}try{e+=o.split(".")[1].length}catch(i){}return Number(n.replace(".",""))*Number(o.replace(".",""))/Math.pow(10,e)},add(t,r){let n,o,i;try{n=t.toString().split(".")[1].length}catch(u){n=0}try{o=r.toString().split(".")[1].length}catch(u){o=0}return i=Math.pow(10,Math.max(n,o)),(e.mul(t,i)+e.mul(r,i))/i},hexMD5(t){function r(t,r){let e=(65535&t)+(65535&r),n=(t>>16)+(r>>16)+(e>>16);return n<<16|65535&e}function e(t,r){return t<<r|t>>>32-r}function n(t,n,o,i,u,c){return r(e(r(r(n,t),r(i,c)),u),o)}function o(t,r,e,o,i,u,c){return n(r&e|~r&o,t,r,i,u,c)}function i(t,r,e,o,i,u,c){return n(r&o|e&~o,t,r,i,u,c)}function u(t,r,e,o,i,u,c){return n(r^e^o,t,r,i,u,c)}function c(t,r,e,o,i,u,c){return n(e^(r|~o),t,r,i,u,c)}function s(t){let e=1732584193,n=-271733879,s=-1732584194,a=271733878;for(let f=0;f<t.length;f+=16){let p=e,l=n,h=s,g=a;e=o(e,n,s,a,t[f+0],7,-680876936),a=o(a,e,n,s,t[f+1],12,-389564586),s=o(s,a,e,n,t[f+2],17,606105819),n=o(n,s,a,e,t[f+3],22,-1044525330),e=o(e,n,s,a,t[f+4],7,-176418897),a=o(a,e,n,s,t[f+5],12,1200080426),s=o(s,a,e,n,t[f+6],17,-1473231341),n=o(n,s,a,e,t[f+7],22,-45705983),e=o(e,n,s,a,t[f+8],7,1770035416),a=o(a,e,n,s,t[f+9],12,-1958414417),s=o(s,a,e,n,t[f+10],17,-42063),n=o(n,s,a,e,t[f+11],22,-1990404162),e=o(e,n,s,a,t[f+12],7,1804603682),a=o(a,e,n,s,t[f+13],12,-40341101),s=o(s,a,e,n,t[f+14],17,-1502002290),n=o(n,s,a,e,t[f+15],22,1236535329),e=i(e,n,s,a,t[f+1],5,-165796510),a=i(a,e,n,s,t[f+6],9,-1069501632),s=i(s,a,e,n,t[f+11],14,643717713),n=i(n,s,a,e,t[f+0],20,-373897302),e=i(e,n,s,a,t[f+5],5,-701558691),a=i(a,e,n,s,t[f+10],9,38016083),s=i(s,a,e,n,t[f+15],14,-660478335),n=i(n,s,a,e,t[f+4],20,-405537848),e=i(e,n,s,a,t[f+9],5,568446438),a=i(a,e,n,s,t[f+14],9,-1019803690),s=i(s,a,e,n,t[f+3],14,-187363961),n=i(n,s,a,e,t[f+8],20,1163531501),e=i(e,n,s,a,t[f+13],5,-1444681467),a=i(a,e,n,s,t[f+2],9,-51403784),s=i(s,a,e,n,t[f+7],14,1735328473),n=i(n,s,a,e,t[f+12],20,-1926607734),e=u(e,n,s,a,t[f+5],4,-378558),a=u(a,e,n,s,t[f+8],11,-2022574463),s=u(s,a,e,n,t[f+11],16,1839030562),n=u(n,s,a,e,t[f+14],23,-35309556),e=u(e,n,s,a,t[f+1],4,-1530992060),a=u(a,e,n,s,t[f+4],11,1272893353),s=u(s,a,e,n,t[f+7],16,-155497632),n=u(n,s,a,e,t[f+10],23,-1094730640),e=u(e,n,s,a,t[f+13],4,681279174),a=u(a,e,n,s,t[f+0],11,-358537222),s=u(s,a,e,n,t[f+3],16,-722521979),n=u(n,s,a,e,t[f+6],23,76029189),e=u(e,n,s,a,t[f+9],4,-640364487),a=u(a,e,n,s,t[f+12],11,-421815835),s=u(s,a,e,n,t[f+15],16,530742520),n=u(n,s,a,e,t[f+2],23,-995338651),e=c(e,n,s,a,t[f+0],6,-198630844),a=c(a,e,n,s,t[f+7],10,1126891415),s=c(s,a,e,n,t[f+14],15,-1416354905),n=c(n,s,a,e,t[f+5],21,-57434055),e=c(e,n,s,a,t[f+12],6,1700485571),a=c(a,e,n,s,t[f+3],10,-1894986606),s=c(s,a,e,n,t[f+10],15,-1051523),n=c(n,s,a,e,t[f+1],21,-2054922799),e=c(e,n,s,a,t[f+8],6,1873313359),a=c(a,e,n,s,t[f+15],10,-30611744),s=c(s,a,e,n,t[f+6],15,-1560198380),n=c(n,s,a,e,t[f+13],21,1309151649),e=c(e,n,s,a,t[f+4],6,-145523070),a=c(a,e,n,s,t[f+11],10,-1120210379),s=c(s,a,e,n,t[f+2],15,718787259),n=c(n,s,a,e,t[f+9],21,-343485551),e=r(e,p),n=r(n,l),s=r(s,h),a=r(a,g)}return[e,n,s,a]}function a(t){let r=[];for(let e=0;e<8*t.length;e+=8)r[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return r[8*t.length>>5]|=128<<8*t.length%32,r[14+(t.length+8>>6<<4)]=8*t.length,r}function f(t){let r="0123456789abcdef",e="";for(let n=0;n<4*t.length;n++)e+=r.charAt(t[n>>2]>>n%4*8+4&15)+r.charAt(t[n>>2]>>n%4*8&15);return e}return f(s(a(t)))},removeQuotes:t=>t.replace(/^['"]|['"]$/g,""),getFiletypeByUrl:function(t){if(!t)return"";let r=new URL(t).pathname;return r.split(".").pop()},fixBaseURL:r=>(t||(t=document.createElement("a")),t.href=r,t.href),parseURL:(t,n=null)=>{const o=`${t}${n?`;${n}`:""}`;if(r.has(o))return r.get(o);if(n){const i=new URL(t,e.fixBaseURL(n));return r.set(o,i),i}const i=new URL(e.fixBaseURL(t));return r.set(t,i),i},getAbsoluteURL:(t,r)=>{if(r.match(/^data\\?\:/))return r;if(/^\/\//.test(r))return`${location.protocol}${r}`;const n=e.parseURL(t),o=e.parseURL(r,n.href);return o.href},getBaseBath:t=>{const r=e.parseURL(t);return`${r.origin}${r.pathname.replace(/\?.*$/,"").replace(/(\/)([^\\/]+)$/i,"$1")}`}};window.__stay_utils=e,window.debounce=(t,r)=>{let e=null;return(...n)=>{e&&clearTimeout(e),e=null,e=setTimeout((()=>{t.apply(this,n)}),r)}},window.throttle=(t,r)=>{let e=null;return(...n)=>{e||(e=setTimeout((()=>{e=null,t.apply(this,n)}),r))}},window.__stay_insert_node=(t,r,e)=>{function n(){if(document[t]){if(e&&document.querySelector(`#${e}`))return;r.isConnected||document[t].appendChild(r)}else{const n=new MutationObserver(((o,i)=>{if(document[t]){if(n.disconnect(),e&&document.querySelector(`#${e}`))return;r.isConnected||document[t].appendChild(r)}}));n.observe(document,{childList:!0,subtree:!0})}}t=t||"body",r&&("loading"!=document.readyState?n():document.addEventListener("readystatechange",(()=>{"loading"!=document.readyState&&n()})))}}

handle__stay_inject_utils_js_1WJOQ33B(false);</script><script type="text/javascript" id="__stay_find_video_utils_">

const handle__stay_find_video_utils_T9BK6J4G = function c(){window.__stay_utils;const t={handleMergeVideoInfo:(t={},e={})=>{if(t.shouldTopUrl=void 0!=typeof e.shouldTopUrl&&e.shouldTopUrl,t.downloadUrl=e.downloadUrl,t.shouldTopUrl&&window==window.top){const e=new URL(window.location.href);e.searchParams.append("stay_source","iframe"),t.downloadUrl=e.toString()}t.audioUrl=e.audioUrl,t.poster=e.poster,t.title=e.title,t.hostUrl=e.hostUrl,t.qualityList=e.qualityList,t.adType=e.adType,t.useDocTitle=e.useDocTitle,t.videoUuid=e.videoUuid,t.videoKey=e.videoKey,t.type=e.type,t.iframe=void 0==typeof e.iframe?window!=window.top:e.iframe},mergeVideoListToWindow:e=>{e&&0!=e.length&&(window.__stay_video_list&&0!=window.__stay_video_list.length?e.forEach((e=>{const n=window.__stay_video_list.some((t=>t.videoKey===e.videoKey));n?window.__stay_video_list.forEach((n=>{if(n.videoKey==e.videoKey)return t.handleMergeVideoInfo(n,e),n})):window.__stay_video_list.push(e)})):window.__stay_video_list=e)}};window.VideoUtils=t;const e=window.matchMedia("(prefers-color-scheme: dark)");function n(){const t={"--s-video-dl-bg":e.matches?"rgb(54, 54, 57)":"rgb(247,247,247)","--s-video-font":e.matches?"rgb(247,247,247)":"rgb(54, 54, 57)","--s-video-hd-bg":e.matches?"#4b4b4b":"#000000","--s-video-posterbg":e.matches?"rgba(0, 0, 0, 1)":"rgba(255, 255, 255, 1)","--s-video-font2":e.matches?"#DCDCDC":"#000000","--s-video-line":e.matches?"#4d4d4d":"#E0E0E0","--s-video-modal-bg":"rgba(0, 0, 0, 0.4)","--s-video-000-bg":"rgba(0,0,0,0)"};for(let[e,n]of Object.entries(t))document.documentElement?document.documentElement.style.setProperty(e,n):document.addEventListener("readystatechange",(()=>{"loading"!=document.readyState&&document.documentElement&&document.documentElement.style.setProperty(e,n)}))}n(),e.addEventListener("change",n)}

handle__stay_find_video_utils_T9BK6J4G(false);</script><script type="text/javascript" id="__stay_inject_find_video_js_">

const handle__stay_inject_find_video_js_3WEDDWEW = function d(t){const e=window.__stay_utils||{},o=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,i=[],r=new Set;class s{constructor(t,e){t&&"yes"===t.getAttribute("stay-long-press")||(this.dom=t,this.timer=0,this.init(e))}init(t){this.touchstart(t),this.touchend(),this.touchmove(),this.bindLongPressEventFlag()}bindLongPressEventFlag(){this.dom.setAttribute("stay-long-press","yes")}touchstart(t){const e=this;e.dom.removeEventListener("touchstart",(function(n){e.handleLongPress(n,t)})),e.dom.addEventListener("touchstart",(function(n){return e.handleTargetTouchend(n.target),e.timer=setTimeout(((t,n)=>{e.handleLongPress(t,n)}),600,n,t),!1}),!1)}handleTargetTouchend(t){const e=this;t&&t.addEventListener("touchend",(n=>{e.handleTouchend(n,t)}))}handleLongPress(t,n){if(t.preventDefault(),t.stopPropagation(),e.isHidden(this.dom))return;let o=t.changedTouches[0];try{o.target.addEventListener("contextmenu",(function(t){t.preventDefault()}))}catch(i){}"function"===typeof n&&(n(),this.timer=0)}touchend(){const t=this;t.dom.removeEventListener("touchend",(function(e){t.handleTouchend(e,null)})),t.dom.addEventListener("touchend",(function(e){return t.handleTouchend(e,null),!1}))}handleTouchend(t,n){const o=this;if(!e.isHidden(this.dom)&&(clearTimeout(this.timer),0!=this.timer))try{n&&n.removeEventListener("touchend",(t=>{clearTimeout(o.timer)}))}catch(i){}}touchmove(){const t=this;function n(n){e.isHidden(t.dom)||(clearTimeout(t.timer),t.timer=0)}t.dom.removeEventListener("touchmove",(function(t){n(t)})),t.dom.addEventListener("touchmove",(function(t){return n(t),!1}))}}class a{constructor(t,e){t&&"yes"===t.getAttribute("stay-long-press")||(this.callback=e,this.dom=t,this.stayLongPressTimer=0,this.distance=10,this.handleTouchStartEvent=this.handleTouchStartEvent.bind(this),this.touchmoveCallback=this.touchmoveCallback.bind(this),this.touchEndCallback=this.touchEndCallback.bind(this),this.init())}getDomPageStartX(){return this.dom.getBoundingClientRect().left}getDomPageStartY(){return(document.documentElement.scrollTop||window.pageYOffset)+this.dom.getBoundingClientRect().top}getDomPageEndX(){return this.getDomPageStartX()+this.dom.clientWidth}getDomPageEndY(){return this.getDomPageStartY()+this.dom.clientHeight}init(){this.stayLongPressTimer=0,this.distance=10,this.touchstart(),this.touchmove(),this.touchend(),this.bindLongPressEventFlag()}removeEvent(){this.stayLongPressTimer&&(clearTimeout(this.stayLongPressTimer),this.stayLongPressTimer=0),this.removeTouchstart(),this.removeTouchmove(),this.removeTouchend()}bindLongPressEventFlag(){this.dom.setAttribute("stay-long-press","yes")}touchstart(){this.removeTouchstart(),document.body.addEventListener("touchstart",this.handleTouchStartEvent)}removeTouchstart(){document.body.removeEventListener("touchstart",this.handleTouchStartEvent)}handleTouchStartEvent(t){const n=this;let o=t.changedTouches[0];if(!o)return;const i=o.pageX,r=o.pageY;!e.isHidden(n.dom)&&Math.abs(o.pageX-i)<=n.distance&&i>=n.getDomPageStartX()&&i<=n.getDomPageEndX()&&r>=n.getDomPageStartY()&&r<=n.getDomPageEndY()&&(t.stopPropagation(),t.preventDefault(),this.stayLongPressTimer=window.setTimeout((t=>{try{let n=t.target.classList;function o(e){e.preventDefault(),t.target.removeEventListener("contextmenu",o)}n.contains("__stay-unselect")||n.add("__stay-unselect"),n.contains("__stay-touch-action")||n.add("__stay-touch-action"),"function"===typeof this.callback&&this.callback(),t.target.addEventListener("contextmenu",o)}catch(e){}}),600,o)),n.handleTargetTouchend(t.target)}handleTargetTouchend(t){const e=this;function n(o){e.touchEndCallback(o),t.removeEventListener("touchend",n)}t&&t.addEventListener("touchend",n)}touchend(){this.removeTouchend(),document.body.addEventListener("touchend",this.touchEndCallback)}removeTouchend(){document.body.removeEventListener("touchend",this.touchEndCallback)}touchEndCallback(t){if(!e.isHidden(this.dom)&&0!=this.stayLongPressTimer)try{clearTimeout(this.stayLongPressTimer),this.stayLongPressTimer=0}catch(n){}}touchmove(){this.removeTouchmove(),document.body.addEventListener("touchmove",this.touchmoveCallback,{passive:!0})}removeTouchmove(){document.body.removeEventListener("touchmove",this.touchmoveCallback,{passive:!0})}touchmoveCallback(t){const n=this;e.isHidden(n.dom)||(window.clearTimeout(n.stayLongPressTimer),n.stayLongPressTimer=0)}}function c(){window===window.top&&window.addEventListener("message",(t=>{t.data.pid;let e=t.data.name;if("PUSH_IFRAME_VIDEO_INFO_TO_PARENT"===e){let e=t.data.videoReact,n=t.data.iframeVideoInfo;n.shouldTopUrl&&(n.downloadUrl=window.location.href);t.data.pageUrl;const o=document.querySelector("iframe");o&&o.getBoundingClientRect()&&(e.x=o.getBoundingClientRect().x,e.y=o.getBoundingClientRect().y),M(n),e&&Object.keys(e).length>0&&R(e,n.videoKey)}}))}async function l(){try{c(),d(),u(),document.addEventListener("readystatechange",(()=>{d()}))}catch(t){}}function d(){if(document.body){const t=document.querySelectorAll("video");f(t)}else{const t=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,e=new t(((t,n)=>{if(document.body){e.disconnect();const t=document.querySelectorAll("video");f(t)}}));e.observe(document.documentElement,{childList:!0,subtree:!0,attributeFilter:["src"]})}}function u(){const t=new o((function(t){try{t.map((function(t){if(t.addedNodes&&"childList"===t.type)t.addedNodes.forEach((t=>{if(t instanceof HTMLElement){let e=t.querySelectorAll("video");const n=Array.from(e);"VIDEO"===t.tagName.toUpperCase()&&n.push(t),f(n)}}));else if("attributes"===t.type){let e=t.target;if("VIDEO"===e.tagName&&"src"===t.attributeName){let t=e.getAttribute("stay-video-uuid");t&&r.delete(t),p(e)}}}))}catch(e){}})),e={attributes:!0,childList:!0,subtree:!0,attributeFilter:["src"]};t.observe(document,e)}function f(t){if(t&&t.length){let e=Array.from(t);e.forEach((t=>{p(t)}))}}function p(t){let n=t.getAttribute("stay-video-uuid");if(n||(n=e.generateUuid(),t.setAttribute("stay-video-uuid",n)),r.has(n))return;r.add(n);let o=t,i=t.getAttribute("src");if(!i){let e=t.querySelector("source");e&&e instanceof HTMLElement&&(o=e,i=e.getAttribute("src"))}if(!i&&window.location.host.indexOf("pornhub.com")<0)r.delete(n);else try{m(t,o,n,i)}catch(s){}}function m(t,n,o,s){let a=t,c={videoKey:o,hostUrl:window.location.href,protect:!1,audioUrl:"",qualityList:[]},l=t.getAttribute("poster")||t.getAttribute("data-poster"),d=t.getAttribute("title")||"",u=t.getAttribute("src")||n.getAttribute("src")||s,f=window.location.host;if(c.type="source",e.isBlobUrl(u)&&(c.type="page"),window!==window.top&&e.isBlobUrl(u)&&(c.shouldTopUrl=!0),!l){let e=t.querySelector("source[type='image/webp'] img");e&&e instanceof HTMLElement&&(l=e.getAttribute("src")||"",d||(d=e.getAttribute("alt")||""))}if(c.poster=l,c.downloadUrl=u,c.title=d,f.indexOf("youtube.com")>-1){a=y.getLongPressDom()||t,y.getVideoInfo(c);let n=e.removeUrlParameter(window.location.href,"app");if(c.downloadUrl=n,c.type="page",!c.downloadUrl||""==c.downloadUrl)return}else if(f.indexOf("baidu.com")>-1)window.BaiduDomHandler.getVideoInfo(c,r,i);else if(f.indexOf("bilibili.com")>-1)c.title=c.title||h.getTitle(),c.poster=c.poster||h.getPoster();else if(f.indexOf("mobile.twitter.com")>-1||f.indexOf("x.com")>-1)c.title=c.title||v.getTitle(t);else if(f.indexOf("m.weibo.cn")>-1)A.getVideoInfo(c);else if(f.indexOf("iesdouyin.com")>-1);else if(f.indexOf("tiktok.com")>-1)c.downloadUrl&&c.downloadUrl.indexOf("/tiktok_web_login_static/tiktok/webapp/main/webapp-desktop")>-1?c.adType="ad":c.adType="content",c.downloadUrl=window.location.href,c.type="page";else if(f.indexOf("douyin.com")>-1){const e=window.location.pathname;e.indexOf("/video")>-1||b.getPCHomeDouyinVideoInfo(t,c)}else if(f.indexOf("m.toutiao.com")>-1)c.poster=c.poster||b.getToutiaoPoster(),c.title=c.title||b.getToutiaoTitle();else if(f.indexOf("m.v.qq.com")>-1)w.getMobileVideoInfo(c);else if(f.indexOf("www.reddit.com")>-1)c.title=c.title||x.getTitle();else if(f.indexOf("pornhub.com")>-1)a=window.PornhubDomHandler.getLongPressDom()||a,window.PornhubDomHandler.getVideoInfo(t,c);else if(f.indexOf("91porn.com")>-1)a=window.PornhubDomHandler.get91PornLongPressDom()||a,c.poster=window.PornhubDomHandler.get91PornPoster()||c.poster;else if(f.indexOf("facebook.com")>-1)T.getVideoInfo(t,c);else if(f.indexOf("instagram.com")>-1)S.getVideoInfo(t,c);else if(f.indexOf("xiaohongshu.com")>-1)E.getVideoInfo(c);else if(f.indexOf("jable.tv")>-1)c.title=c.title||_.getTitle();else if(f.indexOf("hxaa79.com")>-1)c.title=c.title||L.getTitle();else if(f.indexOf("555yy4.com")>-1||f.indexOf("fivezn.com")>-1||f.indexOf("wu5cn.com")>-1)c.title=c.title||U.getTitle();else if(f.indexOf("web.telegram.org")>-1&&u){const t=decodeURIComponent(u);let e=t.match(/"fileName":".*"/g);if(e&&e.length){let t=e[0];t=t.replace('"fileName":',""),d=t.replace(/"/g,"")}}c.downloadUrl&&""!=c.downloadUrl&&(g(c),M(c),c.title&&t.setAttribute("stay-title",c.title),P(t,a,c.videoKey))}function g(t){if(t.iframe=window!=window.top,t.useDocTitle=!1,!t.title){if(window==window.top){const e=document.querySelector("head meta[name='description']");e&&(t.title=e.getAttribute("content")),t.title||(t.title=document.title)}else{try{t.title=window.top.document.title}catch(n){t.title=document.title}t.title="[iframe]"+t.title}t.useDocTitle=!0}t.title||(t.title=e.getUrlPathName(t.downloadUrl),t.useDocTitle=!1),t.poster=e.completionSourceUrl(t.poster),t["title"]=t.adType&&"ad"==t.adType?"<b>Ad·</b>"+t.title:t.title,t.title=t.title?t.title.trim().replace(/\//g,"|"):"",window!==window.top&&/^blob:/i.test(t.downloadUrl)&&(t.shouldTopUrl=!0),t.downloadUrl=e.completionSourceUrl(t.downloadUrl)}class y{static setPlayerBgCss(){const t=document.querySelector("#player-control-overlay");t&&(t.classList.contains("__stay-touch-action")||t.classList.add("__stay-touch-action"),t.classList.contains("__stay-unselect")||t.classList.add("__stay-unselect"));const e=document.querySelector("#player-control-overlay .player-controls-background-container .player-controls-background");e&&(e.classList.contains("__stay-touch-action")||e.classList.add("__stay-touch-action"),e.classList.contains("__stay-unselect")||e.classList.add("__stay-unselect"));let n=document.querySelector("#player-control-container");n&&(n.classList.contains("__stay-unselect")||n.classList.add("__stay-unselect"))}static getLongPressDom(){let t=document.querySelector("#player-control-overlay .player-controls-background-container .player-controls-background");return t||(t=document.querySelector("#player-control-overlay")),t||(t=document.querySelector(".carousel-wrapper .video-wrapper .reel-player-overlay-main-content")),t}static getVideoId(){const t=window.location.href;let n=e.queryURLParams(t,"v")||e.getLastPathParameter(t);if(!n){let t=document.querySelector("#player-control-container > ytm-custom-control > div.inline-player-controls > a.inline-player-overlay");if(t){let o=t.getAttribute("href");n=e.queryParams(o,"v")}}return n}static getVideoInfo(t={}){t.title=this.getTitle(),t.videoUuid=this.getVideoId(),t.poster=t.poster&&""!=t.poster?t.poster:this.getPoster()}static getPoster(){const t=this.getImage();if(!t&&this.getVideoId())return`https://i.ytimg.com/vi/${this.getVideoId()}/hqdefault.jpg`}static getImage(){const t=document.querySelector(".ytp-cued-thumbnail-overlay-image");if(t){let n=t.getAttribute("style");if(n)return e.matchUrlInString(n)}const n=document.querySelector(".html5-video-player .ytp-cued-thumbnail-overlay .ytp-cued-thumbnail-overlay-image");if(n){let t=n.getAttribute("style");if(t)return e.matchUrlInString(t)}const o=document.querySelector(".video-wrapper .background-style-black");if(o){let t=o.getAttribute("style");if(t)return e.matchUrlInString(t)}return""}static getTitle(){const t=document.querySelector(".slim-video-metadata-header .slim-video-information-content .slim-video-information-title");if(t&&t.textContent&&""!=t.textContent.trim()&&!t.textContent.match(/^\s*$/))return t.textContent;const e=document.querySelector("#title h1.style-scope");return e?e.textContent?e.textContent.trim():"":window.ytplayer?.bootstrapPlayerResponse?.videoDetails?.title||document.title}}window.YoutubeDomHandler=y;class h{static getTitle(){let t="",e=document.querySelector(".main-container .ep-info-pre .ep-info-title");if(!e&&(e=document.querySelector(".video .share-video-info .title-wrapper .title .title-name span"),!e)){let n=setTimeout((function(){e=document.querySelector(".video .share-video-info .title-wrapper .title .title-name span"),e&&(t=e.textContent),clearTimeout(n),n=0}),200)}e&&(t=e.textContent);const n=document.querySelector("div.m-video-part-new > ul.list > li.part-item.on > span");if(n){let e=n.textContent;t=e}return t}static getPoster(){let t=null,n=document.querySelector("#artplayer .art-poster");if(n){let o=n.getAttribute("style");o&&(t=e.matchUrlInString(o),t=e.completionSourceUrl(t))}else n=document.querySelector(".player-container .b-img picture source"),n?(t=n.getAttribute("srcset"),t=e.completionSourceUrl(t)):(n=document.querySelector(".player-container .b-img picture img"),n||(n=document.querySelector("#wxwork-share-pic")),n&&(t=n.getAttribute("src"),t=e.completionSourceUrl(t)));if(!t){const n=document.querySelector("meta[itemprop='image']");n&&(t=n.getAttribute("content"),t=e.completionSourceUrl(t))}return t}}class v{static getTitle(t){let n="",o="",i=t.parentNode?.parentNode?.parentNode?.parentNode?.parentNode?.parentNode?.nextElementSibling;return i?o=i.querySelector("div > div > div > div > div > a[data-testid='tweetText'] span"):(i=t.closest('div[data-testid*="cellInnerDiv-tweet"]'),i&&(o=i.querySelector("div[data-testid*='immersive-tweet-ui-content-container'] a[data-testid='tweetText'] span"))),o&&(n=o.textContent),n=e.checkCharLengthAndSubStr(n),n}}class A{static getVideoInfo(t){let n="";if(t&&Object.keys(t)&&t.videoUuid){let o=document.querySelector(".weibo-main .weibo-text a");if(o&&(n=e.queryURLParams(o.getAttribute("href"),"fid"),n==t.videoUuid))return t}if(t.videoUuid=n,document.querySelector(".weibo-main .weibo-text a"),!t.poster){let e=document.querySelector(".weibo-media .weibo-media-wraps .card-video .mwb-video .m-img-box img");e&&(t.poster=e.getAttribute("src"))}window.location.href.match(/^.*\/detail\/.*/g)&&(t.title=e.checkCharLengthAndSubStr(document.querySelector(".weibo-main .weibo-text").textContent))}}class b{static getPCHomeDouyinVideoInfo(t,e={}){if(e.poster&&e.title)return;let n=t.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;if(n){let t=n.querySelector(".imgBackground img");t&&(e.poster=t.getAttribute("src")||e.poster);let o=n.querySelector(".video-info-detail .title span.e_h_fqNj");e.title=o?o.textContent||e.title:e.title||document.title}}static getToutiaoTitle(){const t=document.querySelector(".video .video-header .video-title-wrapper .video-title");if(t)return t.textContent}static getToutiaoPoster(){const t=document.querySelector(".video .xgplayer-placeholder .xgplayer-poster");if(t){let n=t.getAttribute("style");if(n){let t=e.matchUrlInString(n);return t}}}}class w{static getMobileVideoInfo(t={}){if(!t.poster){const n=document.querySelector(".mod_play .player_container .txp_poster_img");if(n){let o=n.getAttribute("src");o=e.completionSourceUrl(o),t.poster=o}}if(!t.title){const e=document.querySelector(".mod_box .mod_bd .mod_video_info .video_title");if(e){let n=e.textContent;n=n?n.trim():"";const o=document.querySelector(".mod_box .mod_bd .mod_list_slider .slider_box .item.current span");o&&(n+=o.textContent,n=n?n.trim():""),t.title=n}}}}class x{static getTitle(){const t=document.querySelector("shreddit-app shreddit-title");return t?t.getAttribute("title"):""}}class T{static getVideoInfo(t,e={}){let n=t.parentElement.parentElement.parentElement.parentElement.parentElement;if(n&&n.classList.contains("displayed")&&"container"==n.getAttribute("data-type")){let t=n.querySelector("div[data-type='video'] img.img");t&&(e.poster=e.poster||t.getAttribute("src"));let o=n.querySelector("div.displayed > div[data-type='container'] > div[data-type='container'] > div[data-type='container'] > div[data-type='text'] > div.native-text");o&&(e.title=e.title||o.textContent)}}}class S{static getVideoInfo(t,e={}){let n=t.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;if(n&&n.classList.contains("_ab8w")&&n.classList.contains("_ab94")&&n.classList.contains("_ab99")&&n.classList.contains("_ab9h")&&n.classList.contains("_ab9m")&&n.classList.contains("_ab9p")&&n.classList.contains("_abcm")){let t=n.querySelector("._aatk .x1uhb9sk .x10l6tqk .x78zum5 img.x5yr21d");t&&(e.poster=e.poster||t.getAttribute("src"));let o=n.querySelector("._ab9f div._ae1h._ae1i ._ae2s div._ae5q._akdn div div div");o&&o.textContent&&(e.title=e.title||o.textContent.replace("... more",""))}else if(n=t.parentNode.parentNode.parentNode.parentNode.parentNode,n&&n.classList.contains("_a8b4")&&n.classList.contains("_acjh")){let t=n.querySelector("div > div > div.x9f619.x1d8287x.xz4gly6  div.x6ikm8r.x10wlt62 span");t&&(e.title=e.title||t.textContent)}}}class E{static getVideoInfo(t={}){const n=document.querySelector(".video-container .video-banner .img-box");if(n){let o=n.getAttribute("style"),i=e.matchUrlInString(o);i&&(t.poster=t.poster||e.completionSourceUrl(i))}const o=document.querySelector(".video-container .stage-bottom .author-desc-wrapper .author-desc");if(o){let n=o.textContent;n&&(n=n.replace(/^展开/g,""),t.title=t.title||e.checkCharLengthAndSubStr(n))}}}class _{static getTitle(){const t=document.querySelector(".video-info .info-header .header-left h4");return t?t.textContent:""}}class L{static getTitle(){const t=document.querySelector(".play_main .play_main_1");return t?t.textContent:""}}class U{static getTitle(){let t=window.parent.document.title;return t||(t=window.parent.ep_title),t||(t=window.parent.MAC.Title),t}}async function M(t){let n=t.downloadUrl;if(!t.videoKey&&!t.videoUuid)return;if(t.videoKey&&!t.videoUuid&&(t.videoUuid=t.videoKey),!e.isURL(n)){let n=window.location.href;window.location.hostname.contains("youtube.com")&&(n=e.removeUrlParameter(n,"app")),t.downloadUrl=n,t.type="page"}let o=!1;i.length&&i.forEach((e=>{(e.videoUuid&&t.videoUuid&&e.videoUuid==t.videoUuid||e.videoKey&&t.videoKey&&e.videoKey==t.videoKey||e.downloadUrl===t.downloadUrl)&&(window.VideoUtils.handleMergeVideoInfo(e,t),o=!0)})),o||(t.videoKey&&r.add(t.videoKey),i.push(t)),O(i)}function O(n){if(window.VideoUtils.mergeVideoListToWindow(n),!t){const t=e.generateUuid();window.postMessage({id:t,pid:t,videoList:n,name:"PUSH_VIDEO_LIST_TO_CONTENT"})}}function P(t,e,n){return new Promise(((t,o)=>{j().then((o=>{o&&"on"==o&&k(e).then((e=>{t(I(e,n))}))}))}))}function k(t){return new Promise(((e,n)=>{let o=window.location.host;o.indexOf("youtube.com")>-1?D((()=>{t=y.getLongPressDom()||t,e(t)})):o.indexOf("pornhub.com")>-1?D((()=>{t=window.PornhubDomHandler.getLongPressDom()||t,e(t)})):o.indexOf("91porn.com")>-1&&D((()=>{t=window.PornhubDomHandler.get91PornLongPressDom()||t,e(t)})),e(t)}))}function D(t){if("interactive"===document.readyState||"complete"===document.readyState)t();else{let e=setTimeout((()=>{t(),clearTimeout(e),e=null}),3e3)}}async function I(t,n){if(!t)return;if(!e.isMobile())return void q(t,n);const o=document.querySelector("#__style_sinffer_unselect");if(!o){let t='<style id="__style_sinffer_unselect">\n          .__stay-unselect, video{\n            -webkit-user-select: none;\n            -moz-user-select: none;\n            -ms-user-select: none;\n            user-select: none;\n            -webkit-touch-callout: none;\n          }\n          .__stay-touch-action{\n            touch-action: auto!important;\n          }\n        </style>';document.body.append(e.parseToDOM(t))}t.classList.add("__stay-unselect"),t.classList.add("__stay-touch-action");const i=window.location.href;if(i.indexOf("youtube.com")>-1)y.setPlayerBgCss(),new s(t,(()=>{N(t,n)}));else if(i.indexOf("pornhub.com")>-1)new s(t,(()=>{N(t,n)}));else if(i.indexOf("muiplayer.js.org")>-1){let e=document.querySelector("#mplayer-media-wrapper");e||(e=document.querySelector("#mplayer-cover")),e?new s(e,(()=>{N(t,n)})):new a(t,(()=>{N(t,n)}))}else new a(t,(()=>{N(t,n)}))}function N(t,e){q(t,e)}function j(){return new Promise(((o,i)=>{if(t)n.get("long_press_status").then((t=>{t=t||"on",o(t)}));else{const t=e.generateUuid(),n=e=>{e.data.pid===t&&"GET_LONG_PRESS_STATUS_RESP"===e.data.name&&(o(e.data.longPressStatusRes),window.removeEventListener("message",n))};window.postMessage({pid:t,name:"GET_LONG_PRESS_STATUS"}),window.addEventListener("message",n)}}))}function q(t,n){if(window===window.top||window.self==window.top){const e=t.getBoundingClientRect();let o=e.y,i=e.x;t.tagName&&"VIDEO"==t.tagName&&(o=t.parentNode.getBoundingClientRect().top,i=t.parentNode.getBoundingClientRect().left),i=10;let r={width:e.width,height:e.height,x:i,y:o};R(r,n)}else{const o=t.getBoundingClientRect();let r={x:o.x,y:o.y,width:o.width,height:o.height};const s=e.generateUuid(),a=i.find((t=>t.videoKey&&t.videoKey==n))||{};window.top.postMessage({pid:s,name:"PUSH_VIDEO_INFO_TO_CONTENT",videoInfo:a,videoReact:r,pageUrl:window.location.href},"*")}}function R(t,n){if(!e.isMobile())return;const o=i.find((t=>t.videoKey&&t.videoKey==n));if(!o)return;t.width;let r=t.height,s=t.y,a=t.x,c=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,l=window.innerWidth||document.documentElement.innerWidth||document.body.innerWidth,d=l,u=e.div(e.mul(d,9),16);r<e.div(c,2)&&(u=r);let f=document.querySelector("#__stay_sinffer_modal");f||(f=y()),f.style.visibility="visible",f.style.display="block";const p=document.querySelector("#__stay_sinffer_modal .e020b4a7-stay-sinffer-popup"),m=document.querySelector("#__stay_sinffer_modal .de17e0-stay-sinffer-content");m.classList.add("a254dt-stay-trans");let g=setTimeout((function(){f.classList.add("c2749e0-stay-show-modal"),p.style.visibility="visible",p.style.display="block",clearTimeout(g),g=0}),400);function y(){let t=o.downloadUrl,n=o.audioUrl?o.audioUrl:"",i=o.type;if(window.location.href.indexOf("youtube.com")>-1){let o=e.removeUrlParameter(window.location.href,"app");e.isMobile()||(t=o,n=o,i="page")}let l=[{type:i,title:o.title,downloadUrl:t,audioUrl:n,poster:o.poster,websiteUrl:o.hostUrl,hostUrl:e.getHostname(o.hostUrl),uuid:""}],d="stay://x-callback-url/snifferVideo?list="+encodeURIComponent(JSON.stringify(l)),f=1,p=`<div stay-download="${d}" class="yt7ec84-stay-quality-item ">${o.adType&&"ad"==o.adType?"Download Ad":"Download"}</div>`,m=o.qualityList;if(m&&m.length){let t="";f=0,m.forEach((n=>{let i=n.downloadUrl,r=n.audioUrl;l=[{type:n.type,title:o.title,downloadUrl:i,poster:o.poster,websiteUrl:o.hostUrl,hostUrl:e.getHostname(o.hostUrl),uuid:"",protect:!!n.protect&&n.protect,audioUrl:r,qualityLabel:n.qualityLabel}],i="stay://x-callback-url/snifferVideo?list="+encodeURIComponent(JSON.stringify(l));let s=n.qualityLabel,a="";if(s)try{s=s.replace(/[^0-9]/g,""),Number(s)>780&&(a='<span class="yt9et8o-stay-hd">HD</span>')}catch(c){}t+=`<div stay-download="${i}" class="yt7ec84-stay-quality-item">${n.qualityLabel}${a}</div>`,f+=1})),p=t}let g=s,y=s;if(s<0)y=0,c<=r&&(y=e.div(e.sub(c,u),2));else if(0==s)c<=r&&(y=e.div(e.sub(c,u),2));else{let t=e.add(4,36),n=e.add(e.add(u,t),e.add(e.mul(f,38),36));s>e.sub(c,n)&&(y=e.sub(c,n))}let h="",v="data:image/png;base64,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",A='<div class="hj7ec8p-stay-poster-box" ><div class="cd7ico4-stay-default-poster"><img style="max-width:100%;max-height:100%;" src="'+v+'"/></div><span style="font-size:13px;padding-top: 20px; -webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;color:var(--s-video-font2);">'+e.getHostname(o.hostUrl)+"</span></div>";o.poster&&(h="border-radius: 15px;",A=`<div class="de1fe0-stay-video-poster" style="background:url('${o.poster}') 50% 50% no-repeat;background-size: cover;"></div>`);let b=`<style id="GuQKtnJA_stay_sinffer_style">\n          .da1fe0-stay-modal-box{\n            position: fixed;\n            z-index: 2147483647;\n            width: 100%;\n            height: 100%;\n            text-align: center;\n            top: 0px;\n            -webkit-overflow-scrolling: touch;\n            margin: 0 auto;\n            transition: all 0.6s;\n            box-sizing: border-box;\n            visibility: hidden;\n            font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue",Helvetica, Arial, "Lucida Grande", sans-serif;\n            -webkit-font-smoothing: antialiased;\n            -moz-osx-font-smoothing: grayscale;\n          }\n          .c2749e0-stay-show-modal{\n            background-color:var(--s-video-modal-bg)!important;\n            -webkit-backdrop-filter: blur(10px);\n          }\n          .de17e0-stay-sinffer-content{\n            background-color:var(--s-video-000-bg)!important;\n            width:100%;\n            position: absolute;\n            left: 0;\n            -webkit-transform: translate3d(0, ${g}px, 0);\n            transform: translate3d(0, ${g}px, 0);\n            will-change: transform;\n            -webkit-transition: -webkit-transform .4s cubic-bezier(0,0,.25,1) 80ms;\n            transition: transform .4s cubic-bezier(0,0,.25,1) 80ms;\n            box-sizing: border-box;\n          }\n          .a254dt-stay-trans{\n            -webkit-transform: translate3d(0,${y}px,0);\n            transform: translate3d(0,${y}px,0);\n          }\n          .pa1ke0-stay-content{\n            background-color:var(--s-video-000-bg)!important;\n            width:100%;\n            position: relative;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            justify-items: center;\n            align-items: center;\n          }\n          .e020b4a7-stay-sinffer-popup{\n            width:230px;\n            padding-top: 10px;\n            padding-bottom: 16px;\n            box-sizing: border-box;\n            border-radius:15px;\n            background-color: var(--s-video-dl-bg);\n            position: relative;\n            margin: 16px auto 0 auto;\n            z-index:999999;\n            visibility: hidden;\n            animation: fadein .5s;\n          }\n          .la1qe0-stay-sinffer-poster{\n            width: 100%;\n            -webkit-user-select: none;\n            -moz-user-select: none;\n            -ms-user-select: none;\n            user-select: none;\n            height: ${u}px;\n            padding: 0 ${a}px;\n            margin:0 auto;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            justify-items: center;\n            align-items: center;\n            box-sizing: border-box;\n            box-shadow: 0 0px 10px rgba(54,54,57,0.1);\n            transition: All 0.4s ease-in-out;\n            -webkit-transition: All 0.4s ease-in-out;\n            -moz-transition: All 0.4s ease-in-out;\n            -o-transition: All 0.4s ease-in-out;\n            animation-name: zoom;\n            animation-duration: 0.6s;\n          }\n          .de1fe0-stay-video-poster{\n            // object-fit: contain;\n            // object-position: center;\n            width:100%;\n            height:100%;\n            background-position: center;\n            background-repeat: no-repeat;\n            border-radius: 15px;\n\n          }\n          .hj7ec8p-stay-poster-box{\n            width:100%;\n            height:100%;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            background-color: var(--s-video-posterbg);\n            border-radius: 10px;\n            box-shadow: 0 0px 10px rgba(54,54,57,0.1);\n          }\n          .cd7ico4-stay-default-poster{\n            width:80px;\n            height:60px;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            justify-items: center;\n            align-items: center;\n            box-sizing: border-box;\n          }\n          .m9alse8-stay-sinffer-title{\n            padding-left: 44px;\n            padding-right: 15px;\n            width: 100%;\n            height: 36px;\n            margin-bottom: 10px;\n            box-sizing: border-box;\n            position: relative;\n            display:flex;\n            flex:1;\n            flex-direction: column;\n            justify-content: center;\n            align-items: flex-start;\n            overflow: hidden;\n          }\n          .t0e9yn-stay-video-title{\n            display: -webkit-box;\n            width: 100%;\n            font-size: 16px;\n            max-height:100%;\n            line-height: 18px;\n            word-break: break-all;\n            word-wrap: break-word;\n            color: var(--s-video-font);\n            -webkit-user-select: none;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            -webkit-line-clamp: 2;\n            text-align: left;\n            flex:1;\n            flex-direction: column;\n            /*! autoprefixer: off */\n            -webkit-box-orient: vertical;   \n          }\n          \n          .m9alse8-stay-sinffer-title::before{\n            content: '';\n            background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD8AAAA8CAMAAADmFZJDAAAApVBMVEUAAAAuMTQvMTQvMTQvMTQuMDQvMTQvMTMvMTUvMDMqMzMuMTQvMTQuMTQuMDQvMTMvMjQwMDQvMTQvMTQvMTMvMjMvMTM+Pj4vMTQwMDAvMDQvMDQvMTQvMTQuMTMvMTMvMTQvMTQuMDQuMTUrKzcvMTQvMTQvMDQvMTQvMTMuMTMsLjQvMTQvMTQvMDMyMjIwMTUvMTMuMTQuMTQvMTQvMTUvMTSVDZmaAAAANnRSTlMASPz56LLajFFdB+B87pFqJBL1qUw4KATxCsfEv52agXE7LR4NuK2VYUMyFtSgdhnMh1bLZj7MdTYuAAAC10lEQVRIx51X54KyMBAMocmBKGIBu9h7vbz/o31fVsiRmATu5lcgGdidnV0UKfEdbDdD38TWzZ7Ouin6Db66E4tw6Gy8qC67fU6IBHjdq8OOXJOosGlXRn5p8i/lH2Zuj/rQHXbUmu6MwxWhKNt77s/tpqGh74uXO3ch1/5lWEQ0V9JbmAB8T1rQ4gmTLzl9m0c4V+yjR57GSFpKlwDsFVJi4OYPkLzBIwAXaeGZ7xQ+NnqwYXqoAr23MUURl3Aba4qjPzliT63EwgSVOQ0bfFZ67OBwWNbVUamKlJUy2yXjQEr92u3t0/Mxu16BJFNUGw9CwSx+gQlx5Y6EzmSJlLhRxrq4AmPf+TLTJwZKQfagQO7UK2TPe9p4t2FXG4BXUm+MRD7AVkycoKTgGqwj5xNzJh29Gd1LIL8I/NQW+Qz+A0kAJYT0FnR1Qgo+5CZxRkg3AubdWMcnpruSmnjL5AvVfIAlNnYX5jld3SESHR8wOnAHDvTekK7OdLWr5BM8KzaZaXxWPqOSL9YIdKELm64aNfj4WO5BMAAb261qvsWZeQn+ZlacSfjaEvaY6V/Q/BX8NWch5hpWSVvL93l5mGtcVklLxVfNgZg13QA+ugslf/MxhxjpgJiBXAX/tFcPIL8khSPlJ/MBkiIsNU3aoReZhH8+qj7E0P5FaPZnBfqEkCcb0HL1m1wtBQW9yQMpkVqs+wFPaFBUG4HwwfgmQg/pcUxEy9uQT7sefTAGx6VluTDUelWLPyUUL6GeYg302pObLCYSVtMbGKIXTR057NdbtfTE/LRGP3n7XStiGhOAJ9kzMGw1NWXMngRwl+4aCQEMF3L28owJIEBy9J3iq51JTON28nGiDjAakxyOywXRvoxwMcsynbVc/DOv7ems1TB2QRg7pUF6RFr0N0SDk4EqsRiq2L6HaqERJ59kPG6lf/4D2bF3EfolMsO7hPF/EV/dg/LN/wBdZOF3i3WinwAAAABJRU5ErkJggg==") 50% 50% no-repeat;\n            background-size: 18px;\n            width: 30px;\n            height: 44px;\n            position: absolute;\n            left: 10px;\n            top: 6px;\n            transform: translate(0, 6px);\n            overflow: hidden;\n            filter: drop-shadow(#6a6a6a 0px -28px);\n            border-top: 25px solid transparent;\n          }\n          .m9alse8-stay-sinffer-title span{\n            font-weight: 600;\n            color:var(--s-video-font2);\n          }\n          .l9pl1tp-stay-sinffer-download{\n            width:100%;\n            box-sizing: border-box;\n            display: flex;\n            justify-content: flex-start;\n            flex-direction: column;\n            align-items: center;\n          }\n          .yt7ec84-stay-quality-item{\n            height: 38px;\n            box-sizing: border-box;\n            width:100%;\n            padding-right: 20px;\n            position: relative;\n            color: var(--s-video-font);\n            text-align:left;\n            font-size: 16px;\n            border-top: 0.5px solid var(--s-video-line);\n            padding: 0 15px;\n            display: flex;\n            align-items: center;\n            -webkit-user-select: none;\n            -moz-user-select: none;\n            -ms-user-select: none;\n            user-select: none;\n            overflow: hidden;\n          }\n          .yt7ec84-stay-quality-item .yt9et8o-stay-hd{\n            border: 1px solid #F7B500;\n            background: var(--s-video-hd-bg);\n            color: #F7B500;\n            font-size: 12px;\n            font-weight: 600;\n            display: inline-block;\n            padding: 0px 4px;\n            border-radius: 4px;\n            margin-left: 10px;\n            align-items: center;\n          }\n          .yt7ec84-stay-quality-item::after{\n            content:"";\n            background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAABCCAMAAAArKNU4AAAAolBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgESU6AAAANXRSTlMAwfbNMNs+eYcSpfzoB9lwJrjjsZyTg1hONxwYjF0eDgTTqqJ2Z2RF9/Huw5d9e2tTSUIs0FWzU8EAAAGXSURBVEjH7ZXbcoIwEEAXRa1G5CIgAiLetd61+/+/VjZkpC1TSF46Y8fzskngMGR2dxZ+J1xHoM6VIWurazYiztW1VqY1X9pLezLN0Ecnt5cTlzRPPHE7F92AgtU7FgxKWh8L+hMQWE1ESY3QQuBoqKThEIgJKmoYPA5ZfAu7OdOS1hUkG/fx4YhbbckEBEhMAdoUXem8DTFDB1hTnEhrZ8wYAfgUx9LaBjOWAG8UdUlN3KnznJoVpCXNuIQ12gjR0X9o4z6ya7VmU29Y3zSdumpercW0cxIAGAjN4jV7rNYMm7atCGCWxT1A4tDBPK3SyONFN+vCPgs2RC3aLuoTkPbooDnVqCG7M17oUnlb8NbnWpOWnmS6D/iVWLpKPCzwQVqjQ8FJqSZ9YZmKpdxB4qzcASZDtgZlDcbmHdQ14qX9O02MjmrKo2MlJo8Uxes30feSLMTPJRTZXeVqSON9R4udaaW1jmEdt5jh8MbCHNaogyFHjOwPVEMDju4oWQMLcgx/Ky01lgY8CAPzYGt12J4ZRPD3fAIh7bTbinL6tgAAAABJRU5ErkJggg==") no-repeat 50% 50%;\n            background-size: 14px;\n            position: absolute;\n            right: -15px;\n            top: 50%;\n            transform: translate(0, -52%);\n            width: 14px;\n            height: 20px;\n            filter: drop-shadow(#6a6a6a -30px 0);\n            border-right: 0px solid transparent;\n          }\n          .l9pl1tp-stay-sinffer-download .yt7ec84-stay-quality-item:last-child {\n            border-bottom: 0.5px solid var(--s-video-line);\n          }\n          @keyframes zoom {\n            0% {transform: scale(1.05)}\n            100% {transform: scale(1);${h}}\n          }\n          @keyframes fadein {\n            0% {\n              transform: translate(0, -100%);\n            }\n            100% {\n              transform: none;\n            }\n          }\n          @keyframes fadeout {\n              0% {\n                transform: translate(0,100%);\n              }\n              100% {\n                  transform: none;\n              }\n          }\n        </style>`,w=['<div id="__stay_sinffer_modal" class="da1fe0-stay-modal-box" >','<div class="de17e0-stay-sinffer-content">','<div class="pa1ke0-stay-content">','<div class="la1qe0-stay-sinffer-poster">'+A+"</div>",'<div class="e020b4a7-stay-sinffer-popup">','<div class="m9alse8-stay-sinffer-title"><div class="t0e9yn-stay-video-title">'+o.title+"</div></div>",'<div class="l9pl1tp-stay-sinffer-download">',p,"</div>","</div>","</div>","</div>","</div>"];return document.head.append(e.parseToDOM(b)),document.body.append(e.parseToDOM(w.join(""))),document.querySelector("#__stay_sinffer_modal")}function h(t){t.preventDefault(),t.stopPropagation(),f.classList.remove("c2749e0-stay-show-modal"),p.style.animation="fadeout .5s;";let e=setTimeout((()=>{if(f){f.removeEventListener("touchstart",h);try{const t=document.querySelector("#__stay_sinffer_modal");t&&t.remove()}catch(t){}}try{const t=document.querySelector("#GuQKtnJA_stay_sinffer_style");t&&t instanceof Node&&t.remove()}catch(t){}C(n),clearTimeout(e),e=null}),200)}f.addEventListener("touchstart",h);const v=document.querySelectorAll("#__stay_sinffer_modal .yt7ec84-stay-quality-item");if(v&&v.length)for(let e=0;e<v.length;e++)(function(t){function n(t){let o=t.target.getAttribute("stay-download"),i=document.createElement("a");i.rel="noopener noreferrer",i.href=o,i.click(),v[e].removeEventListener("touchstart",n)}v[e].addEventListener("touchstart",n)})()}function C(t){if(window.location.host.indexOf("youtube.com")>-1){const e=y.getLongPressDom();e&&I(e,t)}}l()}

handle__stay_inject_find_video_js_3WEDDWEW(false);</script><script type="text/javascript" id="__stay_inject_image_utils_js_">

const handle__stay_inject_image_utils_js_WS4CD7RY = function i(){const t={base64ToBlob:function(t){if(!r.isBase64(t))return"";for(var e=t.split(";base64,"),n=e[0].split(":")[1],o=window.atob(e[1]),i=o.length,c=new Uint8Array(i),u=0;u<i;u++)c[u]=o.charCodeAt(u);return new Blob([c],{type:n})},CONTENT_TYPE:{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",bmp:"image/bmp",webp:"image/webp",svg:"image/svg+xml",ico:"image/x-icon",tif:"image/tiff",tiff:"image/tiff",heic:"image/heic"},IMAGE_SUFFIX:{apng:"apng",bmp:"bmp",gif:"gif",ico:"ico",cur:"ico",pjp:"jpeg",pjpeg:"jpeg",jfif:"jpeg",jpeg:"jpeg",jpg:"jpeg",png:"png",pnj:"png",svg:"svg",tiff:"tiff",tif:"tiff",webp:"webp"},IMAGE_TYPE:{"image/apng":"apng","image/bmp":"bmp","image/gif":"gif","image/x-icon":"ico","image/jpeg":"jpg","image/jpg":"jpg","image/png":"png","image/svg+xml":"svg","image/tiff":"tiff","image/webp":"webp"},calcReact:function(t,r=256,e=256){let n={width:0,height:0};if(t&&r&&e)try{let o=t.width,i=t.height;o<=r&&i<=e?(n.width=o,n.height=i):o/i>=r/e?(n.width=r,n.height=r/o*i):(n.width=e/i*o,n.height=e),(n.width<1||n.height<1)&&(n.width=o,n.height=i)}catch(o){throw new Error("calc react was not ok")}return n},getDomain:function(t){let r=this.getLevel1Domain(t);if(!r)return"";let e=new RegExp(".(com.cn|com|net.cn|net|org.cn|org|gov.cn|gov|cn|mobi|me|info|name|biz|cc|tv|asia|hk|网络|公司|中国)","g");return r.replace(e,"")},getLevel1Domain:function(t){try{if(!r.isURL(t))return;let e="";const n=new URL(t).hostname,o=n.split("."),i=[];i.unshift(o.pop());while(i.length<2)i.unshift(o.pop()),e=i.join(".");return e}catch(e){return""}},isBase64Image:function(t){const r=/^data:image\/(png|jpg|jpeg|gif|svg\+xml);base64,/;return r.test(t)},proxyBase64ToText:function(t){let r="";try{let e=t.split(","),n=e[1];const o=decodeURIComponent(n),i=atob(o);r=(new TextDecoder).decode(new Uint8Array([...i].map((t=>t.charCodeAt(0)))))}catch(e){return""}return r}};window.ImageUtils=t}

handle__stay_inject_image_utils_js_WS4CD7RY(false);</script><style type="text/css">.eruda-search-highlight-block{display:inline}.eruda-search-highlight-block .eruda-keyword{background:#332a00;color:#ffcb6b}</style><style type="text/css">@font-face{font-family:eruda-icon;src:url('data:application/x-font-woff;charset=utf-8;base64,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') format('woff')}[class*=' eruda-icon-'],[class^='eruda-icon-']{font-family:eruda-icon!important;font-size:16px;font-style:normal;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.eruda-icon-arrow-left:before{content:'\f101'}.eruda-icon-arrow-right:before{content:'\f102'}.eruda-icon-caret-down:before{content:'\f103'}.eruda-icon-caret-right:before{content:'\f104'}.eruda-icon-clear:before{content:'\f105'}.eruda-icon-compress:before{content:'\f106'}.eruda-icon-delete:before{content:'\f107'}.eruda-icon-error:before{content:'\f108'}.eruda-icon-expand:before{content:'\f109'}.eruda-icon-eye:before{content:'\f10a'}.eruda-icon-play:before{content:'\f10b'}.eruda-icon-refresh:before{content:'\f10c'}.eruda-icon-reset:before{content:'\f10d'}.eruda-icon-search:before{content:'\f10e'}.eruda-icon-select:before{content:'\f10f'}.eruda-icon-tool:before{content:'\f110'}.eruda-icon-warn:before{content:'\f111'}</style></head>
<body>
<div class="container">
  <h1>Smart AI Grade Calculator</h1>
  <div class="help-overlay" id="helpOverlay">Great job! All grades entered and looking strong!</div>
  <button id="settingsBtn">⚙️</button>
  <div id="settingsPanel">
    <button id="themeBtn">Toggle Theme</button>
    <button id="exportBtn">Export CSV</button>
    <button id="importBtn">Import CSV</button>
    <button id="resetBtn">Reset Data</button>
  </div>
  <div class="card">
    <button id="addRowBtn" class="add-btn">+ Add Grade</button>
    <div class="grades" id="gradesList"><div class="grade-row show" draggable="true"><div class="grade-inputs"><input type="text" placeholder="Enter grade"><button class="remove-btn">X</button></div><div class="suggestion">≈ B</div><div class="grade-bar"><div class="grade-bar-fill" style="width: 75%; background: var(--good);"></div></div></div><div class="grade-row show" draggable="true"><div class="grade-inputs"><input type="text" placeholder="Enter grade"><button class="remove-btn">X</button></div><div class="suggestion">≈ C</div><div class="grade-bar"><div class="grade-bar-fill" style="width: 50%; background: var(--warn);"></div></div></div></div>
    <div class="result" id="result">
      <div class="num animate" id="avgNum">2.50</div>
      <div class="letter" id="letterGrade">B-</div>
      <div class="grade-bar"><div class="grade-bar-fill" id="gradeMeter" style="width: 62.5%; background: var(--warn);"></div></div>
    </div>
    <input type="file" id="fileInput" accept=".csv">
  </div>
</div>

<script>
// Persistent AI Learning Smart Grade Calculator

const gradesList = document.getElementById('gradesList');
const addRowBtn = document.getElementById('addRowBtn');
const avgNum = document.getElementById('avgNum');
const letterGrade = document.getElementById('letterGrade');
const gradeMeter = document.getElementById('gradeMeter');
const exportBtn = document.getElementById('exportBtn');
const importBtn = document.getElementById('importBtn');
const fileInput = document.getElementById('fileInput');
const themeBtn = document.getElementById('themeBtn');
const settingsBtn = document.getElementById('settingsBtn');
const settingsPanel = document.getElementById('settingsPanel');
const helpOverlay = document.getElementById('helpOverlay');
const resetBtn = document.getElementById('resetBtn');

let darkMode = true;

const gradingChart = [
  {grade:"A",min:3.6,max:4.0},{grade:"A-",min:3.31,max:3.6},{grade:"B+",min:3.01,max:3.31},
  {grade:"B",min:2.71,max:3.01},{grade:"B-",min:2.31,max:2.71},{grade:"C+",min:2.01,max:2.31},
  {grade:"C",min:1.71,max:2.01},{grade:"C-",min:1.31,max:1.71},{grade:"D",min:1,max:1.31},{grade:"F",min:0,max:1}
];

// --- Functions to convert grades ---
function letterToNum(letter){
  if(!letter) return null;
  letter = String(letter).trim().toUpperCase();
  const found = gradingChart.find(g => g.grade === letter);
  return found ? (found.min + found.max)/2 : null;
}
function numToLetter(num){
  const found = gradingChart.find(g => num>=g.min && num<g.max);
  return found ? found.grade : "A";
}
function getColor(num){return num>=2.71?'var(--good)':num>=1.71?'var(--warn)':'var(--bad)';}

// --- Persistent Storage ---
function saveGrades(){
  const values = [...gradesList.querySelectorAll('input')].map(i=>i.value.trim());
  localStorage.setItem('grades', JSON.stringify(values));
}
function loadGrades(){
  const data = JSON.parse(localStorage.getItem('grades') || '[]');
  if(data.length){
    gradesList.innerHTML='';
    data.forEach(v=>createInputRow(v));
    calculate(true);
    updateHelpOverlay();
  } else createInputRow();
}

// --- Create input row ---
function createInputRow(val=''){
  const row = document.createElement('div');
  row.className='grade-row'; row.draggable=true;

  const inputContainer = document.createElement('div'); inputContainer.className='grade-inputs';
  const inp = document.createElement('input'); inp.type='text'; inp.placeholder='Enter grade'; inp.value=val;

  const removeBtn = document.createElement('button'); removeBtn.textContent='X'; removeBtn.className='remove-btn';
  removeBtn.addEventListener('click', ()=>{row.remove(); calculate(true); updateHelpOverlay(); saveGrades();});

  inputContainer.appendChild(inp); inputContainer.appendChild(removeBtn);

  const sugg = document.createElement('div'); sugg.className='suggestion';
  const bar = document.createElement('div'); bar.className='grade-bar';
  const barFill = document.createElement('div'); barFill.className='grade-bar-fill';
  bar.appendChild(barFill);

  inp.addEventListener('input', ()=>{
    updateBar(inp,barFill,sugg);
    calculate(true);
    updateHelpOverlay();
    saveGrades();
  });

  row.appendChild(inputContainer); row.appendChild(sugg); row.appendChild(bar);
  gradesList.appendChild(row); setTimeout(()=>row.classList.add('show'),50);
  inp.focus();

  row.addEventListener('dragstart',()=>row.classList.add('dragging'));
  row.addEventListener('dragend',()=>row.classList.remove('dragging'));

  updateBar(inp,barFill,sugg);
}

// --- Update progress bar ---
function updateBar(inp,barFill,sugg){
  const val=inp.value.trim(); let num=parseFloat(val);
  if(isNaN(num)){
    const n = letterToNum(val);
    sugg.textContent = n!==null?`≈ ${n.toFixed(2)}`:'';
    barFill.style.width = n!==null?(n/4*100)+'%':'0%';
    barFill.style.background = getColor(n);
  } else {
    const letter=numToLetter(num);
    sugg.textContent = `≈ ${letter}`;
    barFill.style.width = (num/4*100)+'%';
    barFill.style.background = getColor(num);
  }
}

// --- Calculate average ---
function calculate(animate=false){
  const inputs = gradesList.querySelectorAll('input'); let total=0,count=0;
  inputs.forEach(i=>{
    const val = i.value.trim();
    if(!val) return;
    let num = parseFloat(val);
    if(isNaN(num)) num=letterToNum(val);
    if(num!==null){total+=num; count++;}
  });
  if(count===0){avgNum.textContent='0.00'; letterGrade.textContent='–'; gradeMeter.style.width='0%'; gradeMeter.style.background='var(--bad)'; return;}
  const avg = total/count;
  avgNum.textContent = avg.toFixed(2);
  letterGrade.textContent = numToLetter(avg);
  gradeMeter.style.width = (avg/4*100)+'%';
  gradeMeter.style.background = getColor(avg);
  if(animate){avgNum.classList.remove('animate'); void avgNum.offsetWidth; avgNum.classList.add('animate');}
}

// --- Smart AI help overlay ---
function updateHelpOverlay(){
  const inputs = [...gradesList.querySelectorAll('input')];
  const emptyCount = inputs.filter(i=>!i.value.trim()).length;
  const lowGrades = inputs.filter(i=>{const n=parseFloat(i.value)||letterToNum(i.value); return n!==null && n<2.0;}).length;
  
  if(emptyCount>0) helpOverlay.textContent = `Remember: ${emptyCount} mastery levels missing. Fill them to get accurate average!`;
  else if(lowGrades>0) helpOverlay.textContent = `Heads up: ${lowGrades} low grades detected. Focus to improve your average!`;
  else helpOverlay.textContent = "Great job! All grades entered and looking strong!";
}

// --- Drag & drop ---
gradesList.addEventListener('dragover', e=>{
  e.preventDefault();
  const dragging=document.querySelector('.dragging');
  const afterElement=[...gradesList.querySelectorAll('.grade-row:not(.dragging)')].reduce((closest,child)=>{
    const box=child.getBoundingClientRect();
    const offset=e.clientY-box.top-box.height/2;
    if(offset<0 && offset>closest.offset) return {offset:offset, element:child};
    return closest;
  },{offset:Number.NEGATIVE_INFINITY}).element;
  if(afterElement) gradesList.insertBefore(dragging,afterElement);
  else gradesList.appendChild(dragging);
  calculate(true); updateHelpOverlay(); saveGrades();
});

// --- Settings ---
settingsBtn.addEventListener('click', ()=>{settingsPanel.style.display = settingsPanel.style.display==='flex'?'none':'flex'; settingsPanel.style.flexDirection='column';});
themeBtn.addEventListener('click', ()=>{darkMode=!darkMode; document.body.classList.toggle('light',!darkMode);});
resetBtn.addEventListener('click', ()=>{localStorage.removeItem('grades'); gradesList.innerHTML=''; createInputRow(); calculate(true); updateHelpOverlay();});
exportBtn.addEventListener('click', ()=>{
  const values=[...gradesList.querySelectorAll('input')].map(i=>i.value.trim());
  const csv="data:text/csv;charset=utf-8,"+values.join(",");
  const encoded=encodeURI(csv);
  const link=document.createElement('a'); link.setAttribute('href',encoded); link.setAttribute('download','grades.csv'); document.body.appendChild(link); link.click(); link.remove();
});
importBtn.addEventListener('click', ()=>{fileInput.click();});
fileInput.addEventListener('change', e=>{
  const file=e.target.files[0]; if(!file) return;
  const reader=new FileReader();
  reader.onload=()=>{
    const values = reader.result.split(",");
    gradesList.innerHTML='';
    values.forEach(v=>createInputRow(v));
    calculate(true); updateHelpOverlay(); saveGrades();
  }
  reader.readAsText(file);
});

// --- Init ---
loadGrades();
addRowBtn.addEventListener('click', ()=>{createInputRow(); updateHelpOverlay(); saveGrades();});
</script>


</body><div class="__chii-hide__" style="display: none; position: absolute; pointer-events: none;"><div style="position: absolute; box-sizing: border-box; z-index: 100000;"></div><div style="position: absolute; box-sizing: border-box; z-index: 100000;"></div><div style="position: absolute; box-sizing: border-box; z-index: 100000;"></div><div style="position: absolute; box-sizing: border-box; z-index: 100000;"></div><div style="position: absolute; box-sizing: border-box; z-index: 100000; height: 25px; line-height: 25px; background: rgb(255, 255, 255); color: rgb(34, 34, 34); font-size: 12px; padding: 0px 5px; white-space: nowrap; overflow-x: hidden; box-shadow: rgba(0, 0, 0, 0.05) 0px 2px 2px 0px, rgba(0, 0, 0, 0.08) 0px 1px 4px 0px, rgba(0, 0, 0, 0.2) 0px 3px 1px -2px;"></div></div><div style="all: initial;"></div></html>
