<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Grade Calc</title>
<style>
:root{
  --bg:#0b0f14;
  --card:#11141a;
  --glass: rgba(255,255,255,0.05);
  --accent1:#6a7cff;
  --accent2:#3dd6c6;
  --good:#6fe3b6;
  --warn:#ffbe5b;
  --bad:#ff7d7d;
  --text:#e8eef3;
  --muted:#8a93a2;
  --shadow:0 8px 20px rgba(0,0,0,0.6);
  font-family:"Inter","Segoe UI",Roboto,sans-serif;
}
*{box-sizing:border-box;}
body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:flex-start;
  padding-top:40px;
  background:radial-gradient(900px 600px at 10% 10%, rgba(106,124,255,0.05), transparent),
             radial-gradient(900px 500px at 90% 90%, rgba(61,214,198,0.04), transparent),
             var(--bg);
  color:var(--text);
}
.container{
  width:100%;
  max-width:480px;
  background:var(--card);
  border-radius:25px;
  padding:30px;
  box-shadow:var(--shadow);
  display:flex;
  flex-direction:column;
  gap:20px;
}
h1{
  font-size:2.2rem;
  margin:0;
  background:linear-gradient(90deg,var(--accent1),var(--accent2));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  text-align:center;
}
.grades{
  display:flex;
  flex-direction:column;
  gap:12px;
}
.grade-row{
  display:flex;
  align-items:center;
  gap:12px;
  flex-direction:column;
  cursor:grab;
  user-select:none;
  transition:0.2s;
}
.grade-row.dragging{
  opacity:0.6;
  transform:scale(1.02);
  box-shadow:0 8px 20px rgba(0,0,0,0.4);
}
.grade-inputs{
  display:flex;
  width:100%;
  gap:12px;
}
.grade-row input{
  flex:1;
  padding:10px 14px;
  border-radius:15px;
  border:1px dashed rgba(255,255,255,0.1);
  background:rgba(255,255,255,0.02);
  color:var(--text);
  font-size:16px;
  transition:0.2s;
}
.grade-row input:focus{
  outline:none;
  border-color:var(--accent1);
  background:rgba(255,255,255,0.05);
  box-shadow:0 0 10px rgba(106,124,255,0.3);
}
.remove-btn{
  padding:6px 12px;
  font-size:13px;
  background:var(--bad);
  color:#fff;
  border-radius:12px;
  border:none;
  cursor:pointer;
  transition:0.2s;
}
.remove-btn:hover{
  transform:scale(1.05);
  opacity:0.85;
}
.suggestion{
  font-size:12px;
  color:var(--muted);
  width:100%;
  text-align:left;
}
.grade-bar{
  width:100%;
  height:12px;
  border-radius:8px;
  background:rgba(255,255,255,0.05);
  overflow:hidden;
  margin-top:4px;
}
.grade-bar-fill{
  height:100%;
  width:0%;
  border-radius:8px;
  transition:width 0.3s, background 0.3s;
}
.result{
  text-align:center;
  padding:20px;
  border-radius:20px;
  background:var(--glass);
  border:1px solid rgba(255,255,255,0.06);
  box-shadow:0 6px 20px rgba(0,0,0,0.4);
  display:flex;
  flex-direction:column;
  gap:12px;
}
.result .num{
  font-size:3rem;
  font-weight:700;
  background:linear-gradient(90deg,var(--accent1),var(--accent2));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.result .letter{
  font-size:2rem;
  font-weight:700;
}
.flex-row{
  display:flex;
  gap:10px;
}
button.add-btn{
  flex:1;
  padding:10px;
  font-size:16px;
  border-radius:20px;
  background:linear-gradient(90deg,var(--accent1),var(--accent2));
  color:#071027;
  font-weight:600;
  border:none;
  cursor:pointer;
  transition:0.2s;
}
button.add-btn:hover{
  transform:scale(1.03);
  box-shadow:0 0 15px rgba(106,124,255,0.4);
}
.histogram{
  display:flex;
  gap:6px;
  margin-top:10px;
  height:60px;
}
.hist-bar{
  flex:1;
  border-radius:6px;
  background:rgba(255,255,255,0.05);
  display:flex;
  align-items:flex-end;
  transition:0.3s;
}
.hist-fill{
  width:100%;
  border-radius:6px 6px 0 0;
}
</style>
</head>
<body>
<div class="container">
  <h1>Grade Calc</h1>
  <div class="grades" id="gradesList"></div>
  <div class="flex-row">
    <button id="addRowBtn" class="add-btn">+ Add Grade</button>
  </div>
  <div class="result" id="result">
    <div class="num" id="avgNum">0.00</div>
    <div class="letter" id="letterGrade">–</div>
    <div class="meter"><div class="fill" id="gradeMeter"></div></div>
  </div>
  <div class="histogram" id="histogram"></div>
</div>

<script>
const gradesList = document.getElementById('gradesList');
const addRowBtn = document.getElementById('addRowBtn');
const avgNum = document.getElementById('avgNum');
const letterGrade = document.getElementById('letterGrade');
const gradeMeter = document.getElementById('gradeMeter');
const histogram = document.getElementById('histogram');

const gradingChart=[
  {grade:"A",min:3.6,max:4.0},
  {grade:"A-",min:3.31,max:3.6},
  {grade:"B+",min:3.01,max:3.31},
  {grade:"B",min:2.71,max:3.01},
  {grade:"B-",min:2.31,max:2.71},
  {grade:"C+",min:2.01,max:2.31},
  {grade:"C",min:1.71,max:2.01},
  {grade:"C-",min:1.31,max:1.71},
  {grade:"D",min:1,max:1.31},
  {grade:"F",min:0,max:1}
];

function letterToNum(letter){
  if(!letter) return null;
  letter = String(letter).trim().toUpperCase();
  const found = gradingChart.find(g=>g.grade===letter);
  return found ? (found.min+found.max)/2 : null;
}

function numToLetter(num){
  const found = gradingChart.find(g=>num>=g.min && num<g.max);
  return found ? found.grade : "A";
}

function getColor(num){
  if(num>=2.71) return 'var(--good)';
  if(num>=1.71) return 'var(--warn)';
  return 'var(--bad)';
}

function createInputRow(){
  const row = document.createElement('div');
  row.className='grade-row';
  row.draggable = true;
  
  const inputContainer = document.createElement('div');
  inputContainer.className='grade-inputs';
  
  const inp = document.createElement('input');
  inp.type='text';
  inp.placeholder='Enter grade';
  
  const removeBtn = document.createElement('button');
  removeBtn.textContent='X';
  removeBtn.className='remove-btn';
  removeBtn.title='Remove this grade';
  removeBtn.addEventListener('click',()=>{row.remove(); calculate();});
  
  inputContainer.appendChild(inp);
  inputContainer.appendChild(removeBtn);
  
  const sugg = document.createElement('div');
  sugg.className='suggestion';
  
  const bar = document.createElement('div');
  bar.className='grade-bar';
  const barFill = document.createElement('div');
  barFill.className='grade-bar-fill';
  bar.appendChild(barFill);
  
  inp.addEventListener('input',()=>{
    const val = inp.value.trim();
    let num = parseFloat(val);
    if(isNaN(num)){
      const n = letterToNum(val);
      sugg.textContent = n!==null ? `≈ ${n.toFixed(2)}` : '';
      if(n!==null) barFill.style.width = (n/4*100)+'%';
      barFill.style.background = getColor(n);
    }else{
      const letter = numToLetter(num);
      sugg.textContent = `≈ ${letter}`;
      barFill.style.width = (num/4*100)+'%';
      barFill.style.background = getColor(num);
    }
    calculate();
  });
  
  row.appendChild(inputContainer);
  row.appendChild(sugg);
  row.appendChild(bar);
  gradesList.appendChild(row);
  inp.focus();
  
  // Drag and drop
  row.addEventListener('dragstart', e=>{ row.classList.add('dragging'); });
  row.addEventListener('dragend', e=>{ row.classList.remove('dragging'); });
}

function calculate(){
  const inputs = gradesList.querySelectorAll('input');
  let total=0, count=0;
  let grades = [];
  inputs.forEach(i=>{
    const val = i.value.trim();
    if(!val) return;
    let num = parseFloat(val);
    if(isNaN(num)) num = letterToNum(val);
    if(num!==null){ total+=num; count++; grades.push(num); }
  });
  if(count===0){
    avgNum.textContent='0.00';
    letterGrade.textContent='–';
    gradeMeter.style.width='0%';
    gradeMeter.style.background='var(--bad)';
    histogram.innerHTML='';
    return;
  }
  const avg = total/count;
  avgNum.textContent = avg.toFixed(2);
  letterGrade.textContent = numToLetter(avg);
  const pct = Math.min(100, (avg/4)*100);
  gradeMeter.style.width = pct+'%';
  gradeMeter.style.background = getColor(avg);
  updateHistogram(grades);
}

function updateHistogram(grades){
  histogram.innerHTML='';
  grades.forEach(g=>{
    const bar = document.createElement('div');
    bar.className='hist-bar';
    const fill = document.createElement('div');
    fill.className='hist-fill';
    fill.style.height = (g/4*100)+'%';
    fill.style.background = getColor(g);
    bar.appendChild(fill);
    histogram.appendChild(bar);
  });
}

// Drag & drop logic
gradesList.addEventListener('dragover', e=>{
  e.preventDefault();
  const dragging = document.querySelector('.dragging');
  const afterElement = [...gradesList.querySelectorAll('.grade-row:not(.dragging)')]
    .reduce((closest, child)=>{
      const box = child.getBoundingClientRect();
      const offset = e.clientY - box.top - box.height/2;
      if(offset < 0 && offset > closest.offset) return {offset:offset, element:child};
      else return closest;
    }, {offset:Number.NEGATIVE_INFINITY}).element;
  if(afterElement) gradesList.insertBefore(dragging, afterElement);
  else gradesList.appendChild(dragging);
  calculate();
});

createInputRow();
addRowBtn.addEventListener('click',createInputRow);
</script>
</body>
</html>
